(function(p,f){typeof exports=="object"&&typeof module<"u"?module.exports=f():typeof define=="function"&&define.amd?define(f):(p=typeof globalThis<"u"?globalThis:p||self,p.ImageResizer=f())})(this,function(){"use strict";var Uo=Object.defineProperty;var zo=(p,f,y)=>f in p?Uo(p,f,{enumerable:!0,configurable:!0,writable:!0,value:y}):p[f]=y;var l=(p,f,y)=>(zo(p,typeof f!="symbol"?f+"":f,y),y);var p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function f(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function y(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var K=y;function Ue(e){return e}var W=Ue,ze=K,V=Math.max;function Re(e,t,r){return t=V(t===void 0?e.length-1:t,0),function(){for(var a=arguments,i=-1,n=V(a.length-t,0),o=Array(n);++i<n;)o[i]=a[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=a[i];return s[t]=r(o),ze(e,this,s)}}var Fe=Re;function Ge(e){return function(){return e}}var qe=Ge,ke=typeof p=="object"&&p&&p.Object===Object&&p,X=ke,Ne=X,He=typeof self=="object"&&self&&self.Object===Object&&self,Ke=Ne||He||Function("return this")(),b=Ke,We=b,Ve=We.Symbol,Q=Ve,J=Q,Y=Object.prototype,Xe=Y.hasOwnProperty,Qe=Y.toString,S=J?J.toStringTag:void 0;function Je(e){var t=Xe.call(e,S),r=e[S];try{e[S]=void 0;var a=!0}catch{}var i=Qe.call(e);return a&&(t?e[S]=r:delete e[S]),i}var Ye=Je,Ze=Object.prototype,et=Ze.toString;function tt(e){return et.call(e)}var rt=tt,Z=Q,at=Ye,it=rt,nt="[object Null]",st="[object Undefined]",ee=Z?Z.toStringTag:void 0;function ot(e){return e==null?e===void 0?st:nt:ee&&ee in Object(e)?at(e):it(e)}var T=ot;function lt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var v=lt,ct=T,ht=v,ut="[object AsyncFunction]",dt="[object Function]",pt="[object GeneratorFunction]",ft="[object Proxy]";function vt(e){if(!ht(e))return!1;var t=ct(e);return t==dt||t==pt||t==ut||t==ft}var z=vt,gt=b,yt=gt["__core-js_shared__"],bt=yt,R=bt,te=function(){var e=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function _t(e){return!!te&&te in e}var $t=_t,mt=Function.prototype,xt=mt.toString;function Ot(e){if(e!=null){try{return xt.call(e)}catch{}try{return e+""}catch{}}return""}var Ct=Ot,St=z,wt=$t,jt=v,Tt=Ct,At=/[\\^$.*+?()[\]{}|]/g,Mt=/^\[object .+?Constructor\]$/,It=Function.prototype,Pt=Object.prototype,Et=It.toString,Dt=Pt.hasOwnProperty,Lt=RegExp("^"+Et.call(Dt).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Bt(e){if(!jt(e)||wt(e))return!1;var t=St(e)?Lt:Mt;return t.test(Tt(e))}var Ut=Bt;function zt(e,t){return e==null?void 0:e[t]}var Rt=zt,Ft=Ut,Gt=Rt;function qt(e,t){var r=Gt(e,t);return Ft(r)?r:void 0}var F=qt,kt=F,Nt=function(){try{var e=kt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),re=Nt,Ht=qe,ae=re,Kt=W,Wt=ae?function(e,t){return ae(e,"toString",{configurable:!0,enumerable:!1,value:Ht(t),writable:!0})}:Kt,Vt=Wt,Xt=800,Qt=16,Jt=Date.now;function Yt(e){var t=0,r=0;return function(){var a=Jt(),i=Qt-(a-r);if(r=a,i>0){if(++t>=Xt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Zt=Yt,er=Vt,tr=Zt,rr=tr(er),ar=rr,ir=W,nr=Fe,sr=ar;function or(e,t){return sr(nr(e,t,ir),e+"")}var ie=or;function lr(){this.__data__=[],this.size=0}var cr=lr;function hr(e,t){return e===t||e!==e&&t!==t}var A=hr,ur=A;function dr(e,t){for(var r=e.length;r--;)if(ur(e[r][0],t))return r;return-1}var M=dr,pr=M,fr=Array.prototype,vr=fr.splice;function gr(e){var t=this.__data__,r=pr(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():vr.call(t,r,1),--this.size,!0}var yr=gr,br=M;function _r(e){var t=this.__data__,r=br(t,e);return r<0?void 0:t[r][1]}var $r=_r,mr=M;function xr(e){return mr(this.__data__,e)>-1}var Or=xr,Cr=M;function Sr(e,t){var r=this.__data__,a=Cr(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}var wr=Sr,jr=cr,Tr=yr,Ar=$r,Mr=Or,Ir=wr;function _(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}_.prototype.clear=jr,_.prototype.delete=Tr,_.prototype.get=Ar,_.prototype.has=Mr,_.prototype.set=Ir;var I=_,Pr=I;function Er(){this.__data__=new Pr,this.size=0}var Dr=Er;function Lr(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Br=Lr;function Ur(e){return this.__data__.get(e)}var zr=Ur;function Rr(e){return this.__data__.has(e)}var Fr=Rr,Gr=F,qr=b,kr=Gr(qr,"Map"),ne=kr,Nr=F,Hr=Nr(Object,"create"),P=Hr,se=P;function Kr(){this.__data__=se?se(null):{},this.size=0}var Wr=Kr;function Vr(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Xr=Vr,Qr=P,Jr="__lodash_hash_undefined__",Yr=Object.prototype,Zr=Yr.hasOwnProperty;function ea(e){var t=this.__data__;if(Qr){var r=t[e];return r===Jr?void 0:r}return Zr.call(t,e)?t[e]:void 0}var ta=ea,ra=P,aa=Object.prototype,ia=aa.hasOwnProperty;function na(e){var t=this.__data__;return ra?t[e]!==void 0:ia.call(t,e)}var sa=na,oa=P,la="__lodash_hash_undefined__";function ca(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=oa&&t===void 0?la:t,this}var ha=ca,ua=Wr,da=Xr,pa=ta,fa=sa,va=ha;function $(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}$.prototype.clear=ua,$.prototype.delete=da,$.prototype.get=pa,$.prototype.has=fa,$.prototype.set=va;var ga=$,oe=ga,ya=I,ba=ne;function _a(){this.size=0,this.__data__={hash:new oe,map:new(ba||ya),string:new oe}}var $a=_a;function ma(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var xa=ma,Oa=xa;function Ca(e,t){var r=e.__data__;return Oa(t)?r[typeof t=="string"?"string":"hash"]:r.map}var E=Ca,Sa=E;function wa(e){var t=Sa(this,e).delete(e);return this.size-=t?1:0,t}var ja=wa,Ta=E;function Aa(e){return Ta(this,e).get(e)}var Ma=Aa,Ia=E;function Pa(e){return Ia(this,e).has(e)}var Ea=Pa,Da=E;function La(e,t){var r=Da(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}var Ba=La,Ua=$a,za=ja,Ra=Ma,Fa=Ea,Ga=Ba;function m(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}m.prototype.clear=Ua,m.prototype.delete=za,m.prototype.get=Ra,m.prototype.has=Fa,m.prototype.set=Ga;var qa=m,ka=I,Na=ne,Ha=qa,Ka=200;function Wa(e,t){var r=this.__data__;if(r instanceof ka){var a=r.__data__;if(!Na||a.length<Ka-1)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ha(a)}return r.set(e,t),this.size=r.size,this}var Va=Wa,Xa=I,Qa=Dr,Ja=Br,Ya=zr,Za=Fr,ei=Va;function x(e){var t=this.__data__=new Xa(e);this.size=t.size}x.prototype.clear=Qa,x.prototype.delete=Ja,x.prototype.get=Ya,x.prototype.has=Za,x.prototype.set=ei;var ti=x,le=re;function ri(e,t,r){t=="__proto__"&&le?le(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var G=ri,ai=G,ii=A;function ni(e,t,r){(r!==void 0&&!ii(e[t],r)||r===void 0&&!(t in e))&&ai(e,t,r)}var ce=ni;function si(e){return function(t,r,a){for(var i=-1,n=Object(t),o=a(t),s=o.length;s--;){var c=o[e?s:++i];if(r(n[c],c,n)===!1)break}return t}}var oi=si,li=oi,ci=li(),hi=ci,D={exports:{}};D.exports,function(e,t){var r=b,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,n=i&&i.exports===a,o=n?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var g=u.length,C=s?s(g):new u.constructor(g);return u.copy(C),C}e.exports=c}(D,D.exports);var ui=D.exports,di=b,pi=di.Uint8Array,fi=pi,he=fi;function vi(e){var t=new e.constructor(e.byteLength);return new he(t).set(new he(e)),t}var gi=vi,yi=gi;function bi(e,t){var r=t?yi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var _i=bi;function $i(e,t){var r=-1,a=e.length;for(t||(t=Array(a));++r<a;)t[r]=e[r];return t}var mi=$i,xi=v,ue=Object.create,Oi=function(){function e(){}return function(t){if(!xi(t))return{};if(ue)return ue(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Ci=Oi;function Si(e,t){return function(r){return e(t(r))}}var wi=Si,ji=wi,Ti=ji(Object.getPrototypeOf,Object),de=Ti,Ai=Object.prototype;function Mi(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ai;return e===r}var pe=Mi,Ii=Ci,Pi=de,Ei=pe;function Di(e){return typeof e.constructor=="function"&&!Ei(e)?Ii(Pi(e)):{}}var Li=Di;function Bi(e){return e!=null&&typeof e=="object"}var w=Bi,Ui=T,zi=w,Ri="[object Arguments]";function Fi(e){return zi(e)&&Ui(e)==Ri}var Gi=Fi,fe=Gi,qi=w,ve=Object.prototype,ki=ve.hasOwnProperty,Ni=ve.propertyIsEnumerable,Hi=fe(function(){return arguments}())?fe:function(e){return qi(e)&&ki.call(e,"callee")&&!Ni.call(e,"callee")},ge=Hi,Ki=Array.isArray,ye=Ki,Wi=9007199254740991;function Vi(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Wi}var be=Vi,Xi=z,Qi=be;function Ji(e){return e!=null&&Qi(e.length)&&!Xi(e)}var q=Ji,Yi=q,Zi=w;function en(e){return Zi(e)&&Yi(e)}var tn=en,L={exports:{}};function rn(){return!1}var an=rn;L.exports,function(e,t){var r=b,a=an,i=t&&!t.nodeType&&t,n=i&&!0&&e&&!e.nodeType&&e,o=n&&n.exports===i,s=o?r.Buffer:void 0,c=s?s.isBuffer:void 0,u=c||a;e.exports=u}(L,L.exports);var _e=L.exports,nn=T,sn=de,on=w,ln="[object Object]",cn=Function.prototype,hn=Object.prototype,$e=cn.toString,un=hn.hasOwnProperty,dn=$e.call(Object);function pn(e){if(!on(e)||nn(e)!=ln)return!1;var t=sn(e);if(t===null)return!0;var r=un.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&$e.call(r)==dn}var fn=pn,vn=T,gn=be,yn=w,bn="[object Arguments]",_n="[object Array]",$n="[object Boolean]",mn="[object Date]",xn="[object Error]",On="[object Function]",Cn="[object Map]",Sn="[object Number]",wn="[object Object]",jn="[object RegExp]",Tn="[object Set]",An="[object String]",Mn="[object WeakMap]",In="[object ArrayBuffer]",Pn="[object DataView]",En="[object Float32Array]",Dn="[object Float64Array]",Ln="[object Int8Array]",Bn="[object Int16Array]",Un="[object Int32Array]",zn="[object Uint8Array]",Rn="[object Uint8ClampedArray]",Fn="[object Uint16Array]",Gn="[object Uint32Array]",h={};h[En]=h[Dn]=h[Ln]=h[Bn]=h[Un]=h[zn]=h[Rn]=h[Fn]=h[Gn]=!0,h[bn]=h[_n]=h[In]=h[$n]=h[Pn]=h[mn]=h[xn]=h[On]=h[Cn]=h[Sn]=h[wn]=h[jn]=h[Tn]=h[An]=h[Mn]=!1;function qn(e){return yn(e)&&gn(e.length)&&!!h[vn(e)]}var kn=qn;function Nn(e){return function(t){return e(t)}}var Hn=Nn,B={exports:{}};B.exports,function(e,t){var r=X,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,n=i&&i.exports===a,o=n&&r.process,s=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s}(B,B.exports);var Kn=B.exports,Wn=kn,Vn=Hn,me=Kn,xe=me&&me.isTypedArray,Xn=xe?Vn(xe):Wn,Oe=Xn;function Qn(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ce=Qn,Jn=G,Yn=A,Zn=Object.prototype,es=Zn.hasOwnProperty;function ts(e,t,r){var a=e[t];(!(es.call(e,t)&&Yn(a,r))||r===void 0&&!(t in e))&&Jn(e,t,r)}var rs=ts,as=rs,is=G;function ns(e,t,r,a){var i=!r;r||(r={});for(var n=-1,o=t.length;++n<o;){var s=t[n],c=a?a(r[s],e[s],s,r,e):void 0;c===void 0&&(c=e[s]),i?is(r,s,c):as(r,s,c)}return r}var ss=ns;function os(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}var ls=os,cs=9007199254740991,hs=/^(?:0|[1-9]\d*)$/;function us(e,t){var r=typeof e;return t=t??cs,!!t&&(r=="number"||r!="symbol"&&hs.test(e))&&e>-1&&e%1==0&&e<t}var Se=us,ds=ls,ps=ge,fs=ye,vs=_e,gs=Se,ys=Oe,bs=Object.prototype,_s=bs.hasOwnProperty;function $s(e,t){var r=fs(e),a=!r&&ps(e),i=!r&&!a&&vs(e),n=!r&&!a&&!i&&ys(e),o=r||a||i||n,s=o?ds(e.length,String):[],c=s.length;for(var u in e)(t||_s.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||n&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||gs(u,c)))&&s.push(u);return s}var ms=$s;function xs(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Os=xs,Cs=v,Ss=pe,ws=Os,js=Object.prototype,Ts=js.hasOwnProperty;function As(e){if(!Cs(e))return ws(e);var t=Ss(e),r=[];for(var a in e)a=="constructor"&&(t||!Ts.call(e,a))||r.push(a);return r}var Ms=As,Is=ms,Ps=Ms,Es=q;function Ds(e){return Es(e)?Is(e,!0):Ps(e)}var we=Ds,Ls=ss,Bs=we;function Us(e){return Ls(e,Bs(e))}var zs=Us,je=ce,Rs=ui,Fs=_i,Gs=mi,qs=Li,Te=ge,Ae=ye,ks=tn,Ns=_e,Hs=z,Ks=v,Ws=fn,Vs=Oe,Me=Ce,Xs=zs;function Qs(e,t,r,a,i,n,o){var s=Me(e,r),c=Me(t,r),u=o.get(c);if(u){je(e,r,u);return}var d=n?n(s,c,r+"",e,t,o):void 0,g=d===void 0;if(g){var C=Ae(c),H=!C&&Ns(c),Be=!C&&!H&&Vs(c);d=c,C||H||Be?Ae(s)?d=s:ks(s)?d=Gs(s):H?(g=!1,d=Rs(c,!0)):Be?(g=!1,d=Fs(c,!0)):d=[]:Ws(c)||Te(c)?(d=s,Te(s)?d=Xs(s):(!Ks(s)||Hs(s))&&(d=qs(c))):g=!1}g&&(o.set(c,d),i(d,c,a,n,o),o.delete(c)),je(e,r,d)}var Js=Qs,Ys=ti,Zs=ce,eo=hi,to=Js,ro=v,ao=we,io=Ce;function Ie(e,t,r,a,i){e!==t&&eo(t,function(n,o){if(i||(i=new Ys),ro(n))to(e,t,o,r,Ie,a,i);else{var s=a?a(io(e,o),n,o+"",e,t,i):void 0;s===void 0&&(s=n),Zs(e,o,s)}},ao)}var Pe=Ie,no=Pe,Ee=v;function De(e,t,r,a,i,n){return Ee(e)&&Ee(t)&&(n.set(t,e),no(e,t,void 0,De,n),n.delete(t)),e}var so=De,oo=A,lo=q,co=Se,ho=v;function uo(e,t,r){if(!ho(r))return!1;var a=typeof t;return(a=="number"?lo(r)&&co(t,r.length):a=="string"&&t in r)?oo(r[t],e):!1}var po=uo,fo=ie,vo=po;function go(e){return fo(function(t,r){var a=-1,i=r.length,n=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(n=e.length>3&&typeof n=="function"?(i--,n):void 0,o&&vo(r[0],r[1],o)&&(n=i<3?void 0:n,i=1),t=Object(t);++a<i;){var s=r[a];s&&e(t,s,a,n)}return t})}var yo=go,bo=Pe,_o=yo,$o=_o(function(e,t,r,a){bo(e,t,r,a)}),mo=$o,xo=K,Oo=ie,Co=so,So=mo,wo=Oo(function(e){return e.push(void 0,Co),xo(So,void 0,e)}),jo=wo;const To=f(jo),Ao={modules:["DisplaySize","Toolbar","Resize"],overlayStyles:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"},handleStyles:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},displayStyles:{position:"absolute",font:"12px/1.0 Arial, Helvetica, sans-serif",padding:"4px 8px",textAlign:"center",backgroundColor:"white",color:"#333",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80",cursor:"default"},toolbarStyles:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default"},toolbarButtonStyles:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},toolbarButtonSvgStyles:{fill:"#444",stroke:"#444",strokeWidth:"2"}};class k{constructor(t){l(this,"onCreate",()=>{});l(this,"onDestroy",()=>{});l(this,"onUpdate",()=>{});this.overlay=t.overlay,this.img=t.img,this.options=t.options,this.requestUpdate=t.onUpdate}}class Mo extends k{constructor(){super(...arguments);l(this,"onCreate",()=>{this.display=document.createElement("div"),Object.assign(this.display.style,this.options.displayStyles),this.overlay.appendChild(this.display)});l(this,"onDestroy",()=>{});l(this,"onUpdate",()=>{if(!this.display||!this.img)return;const r=this.getCurrentSize();if(this.display.innerHTML=r.join(" &times; "),r[0]>120&&r[1]>30)Object.assign(this.display.style,{right:"4px",bottom:"4px",left:"auto"});else if(this.img.style.float=="right"){const a=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:"auto",bottom:`-${a.height+4}px`,left:`-${a.width+4}px`})}else{const a=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:`-${a.width+4}px`,bottom:`-${a.height+4}px`,left:"auto"})}});l(this,"getCurrentSize",()=>[this.img.width,Math.round(this.img.width/this.img.naturalWidth*this.img.naturalHeight)])}}const Io=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>
</svg>`,Po=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>
</svg>`,Eo=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>
</svg>`,N=window.Quill.imports.parchment,O=new N.StyleAttributor("float","float"),j=new N.StyleAttributor("margin","margin"),U=new N.StyleAttributor("display","display");class Do extends k{constructor(){super(...arguments);l(this,"onCreate",()=>{this.toolbar=document.createElement("div"),Object.assign(this.toolbar.style,this.options.toolbarStyles),this.overlay.appendChild(this.toolbar),this._defineAlignments(),this._addToolbarButtons()});l(this,"onDestroy",()=>{});l(this,"onUpdate",()=>{});l(this,"_defineAlignments",()=>{this.alignments=[{icon:Io,apply:()=>{U.add(this.img,"inline"),O.add(this.img,"left"),j.add(this.img,"0 1em 1em 0")},isApplied:()=>O.value(this.img)=="left"},{icon:Po,apply:()=>{U.add(this.img,"block"),O.remove(this.img),j.add(this.img,"auto")},isApplied:()=>j.value(this.img)=="auto"},{icon:Eo,apply:()=>{U.add(this.img,"inline"),O.add(this.img,"right"),j.add(this.img,"0 0 1em 1em")},isApplied:()=>O.value(this.img)=="right"}]});l(this,"_addToolbarButtons",()=>{const r=[];this.alignments.forEach((a,i)=>{const n=document.createElement("span");r.push(n),n.innerHTML=a.icon,n.addEventListener("click",()=>{r.forEach(o=>o.style.filter=""),a.isApplied()?(O.remove(this.img),j.remove(this.img),U.remove(this.img)):(this._selectButton(n),a.apply()),this.requestUpdate()}),Object.assign(n.style,this.options.toolbarButtonStyles),i>0&&(n.style.borderLeftWidth="0"),Object.assign(n.children[0].style,this.options.toolbarButtonSvgStyles),a.isApplied()&&this._selectButton(n),this.toolbar.appendChild(n)})});l(this,"_selectButton",r=>{r.style.filter="invert(20%)"})}}class Lo extends k{constructor(){super(...arguments);l(this,"onCreate",()=>{this.boxes=[],this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.positionBoxes()});l(this,"onDestroy",()=>{this.setCursor("")});l(this,"positionBoxes",()=>{const r=`${-parseFloat(this.options.handleStyles.width)/2}px`,a=`${-parseFloat(this.options.handleStyles.height)/2}px`;[{left:r,top:a},{right:r,top:a},{right:r,bottom:a},{left:r,bottom:a}].forEach((i,n)=>{Object.assign(this.boxes[n].style,i)})});l(this,"addBox",r=>{const a=document.createElement("div");Object.assign(a.style,this.options.handleStyles),a.style.cursor=r,a.style.width=`${this.options.handleStyles.width}px`,a.style.height=`${this.options.handleStyles.height}px`,a.addEventListener("mousedown",this.handleMousedown,!1),this.overlay.appendChild(a),this.boxes.push(a)});l(this,"handleMousedown",r=>{this.dragBox=r.target,this.dragStartX=r.clientX,this.preDragWidth=this.img.width||this.img.naturalWidth,this.setCursor(this.dragBox.style.cursor),document.addEventListener("mousemove",this.handleDrag,!1),document.addEventListener("mouseup",this.handleMouseup,!1)});l(this,"handleMouseup",()=>{this.setCursor(""),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleMouseup)});l(this,"handleDrag",r=>{if(!this.img)return;const a=r.clientX-this.dragStartX;this.dragBox===this.boxes[0]||this.dragBox===this.boxes[3]?this.img.width=Math.round(this.preDragWidth-a):this.img.width=Math.round(this.preDragWidth+a),this.requestUpdate()});l(this,"setCursor",r=>{[document.body,this.img].forEach(a=>{a.style.cursor=r})})}}const Bo={DisplaySize:Mo,Toolbar:Do,Resize:Lo};class Le{constructor(t,r={}){l(this,"onUpdate",()=>{this.repositionElements(),this.modules.forEach(t=>{t.onUpdate()})});l(this,"removeModules",()=>{this.modules.forEach(t=>{t.onDestroy()}),this.modules=[]});l(this,"handleClick",t=>{if(t.target&&t.target.tagName&&t.target.tagName.toUpperCase()==="IMG"){if(this.img===t.target)return;this.img&&this.hide(),this.show(t.target)}else this.img&&this.hide()});l(this,"show",t=>{this.img=t,this.showOverlay(),this.initializeModules()});l(this,"showOverlay",()=>{this.overlay&&this.hideOverlay(),this.quill.setSelection(null),this.setUserSelect("none"),document.addEventListener("keyup",this.checkImage,!0),this.quill.root.addEventListener("input",this.checkImage,!0),this.overlay=document.createElement("div"),Object.assign(this.overlay.style,this.options.overlayStyles),this.quill.root.parentNode.appendChild(this.overlay),this.repositionElements()});l(this,"hideOverlay",()=>{this.overlay&&(this.quill.root.parentNode.removeChild(this.overlay),this.overlay=void 0,document.removeEventListener("keyup",this.checkImage),this.quill.root.removeEventListener("input",this.checkImage),this.setUserSelect(""))});l(this,"repositionElements",()=>{if(!this.overlay||!this.img)return;const t=this.quill.root.parentNode,r=this.img.getBoundingClientRect(),a=t.getBoundingClientRect();Object.assign(this.overlay.style,{left:`${r.left-a.left-1+t.scrollLeft}px`,top:`${r.top-a.top+t.scrollTop}px`,width:`${r.width}px`,height:`${r.height}px`})});l(this,"hide",()=>{this.hideOverlay(),this.removeModules(),this.img=void 0});l(this,"setUserSelect",t=>{["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach(r=>{this.quill.root.style[r]=t,document.documentElement.style[r]=t})});l(this,"checkImage",t=>{this.img&&((t.keyCode==46||t.keyCode==8)&&window.Quill.find(this.img).deleteAt(0),this.hide())});this.initializeModules=this.initializeModules.bind(this),this.quill=t;let a=!1;r.modules&&(a=r.modules.slice()),this.options=To({},r,Ao),a!==!1&&(this.options.modules=a),this.quill.root.addEventListener("click",this.handleClick,!1),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.moduleClasses=this.options.modules,this.modules=[]}initializeModules(){this.removeModules(),this.modules=this.moduleClasses.map(t=>new(Bo[t]||t)(this)),this.modules.forEach(t=>{t.onCreate()}),this.onUpdate()}}return window.Quill&&(console.log("testitest"),window.Quill.register("modules/imageResizer",Le)),Le});
